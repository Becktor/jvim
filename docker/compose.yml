services:
  jvim:
    build:
      context: .
      dockerfile: Dockerfile
      target: dev
      args:
        JVIM_BASE: ${JVIM_BASE:-ghcr.io/becktor/jvim:latest}
        TMUX_VERSION: ${TMUX_VERSION:-}
    image: jvim:${USER_UID:-1000}
    container_name: jvim
    hostname: jvim
    stdin_open: true
    tty: true

    volumes:
      # Persist plugin data between runs
      - nvim-data:/home/nvim/.local/share/nvim

      # Mount nvim config from dotfiles (editable at runtime)
      - ${DOTFILES_PATH:-~/git/dotfiles}/nvim:/home/nvim/.config/nvim

      # Mount workspace/projects
      - ${WORKSPACE:-~/projects}:/home/nvim/workspace

    environment:
      - TERM=xterm-256color
      - COLORTERM=truecolor

    working_dir: /home/nvim/workspace

volumes:
  nvim-data:
    name: jvim-data
